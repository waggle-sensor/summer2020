This script prepares the [Chars74K](http://www.ee.surrey.ac.uk/CVSSP/demos/chars74k/) dataset for training with YOLOv3.

To begin, create a folder (specified by `DATA` in the script) with the following subdirectories:

* `images`: contains extracted English letter images (not masks), with subfolders `GoodImag` and `BadImag`. These subfolders each contain folders `Sample001` through `Sample062`, corresponding to 0-9, A-Z, and a-z (in that order)
* `labels`: empty folder that will contain labels generated by `cleanup.py`

Afterwards, run `cleanup.py`. This will generate class names based on the most frequent classes within the dataset. The images belonging to these classes will then be split up into testing and training sets. All selected images will also be labeled.

The `augment.py` script can be used to augment the training dataset via the `albumentations` library. Run it with the command `python3 augment.py train.txt`. It has 8 filters, each run for 5 trials, which will augment a data set by 40x.

Upon finish, the script also creates labels for the transformed image.

### Preparing `images`

```
wget http://www.ee.surrey.ac.uk/CVSSP/demos/chars74k/EnglishImg.tgz
tar xvzf EnglishImg.tgz
mv English/Img images
cd images
mv GoodImag/Bmp/* GoodImg/
mv BadImag/Bmp/* BadImag/
rm -r BadImag/Msk/
rm -r GoodImag/Msk/
```

### Pipeline

After linking the `data` directory to the right locations:

```
python3 cleanup.py
python3 augment.py output/config/train.txt
mv output/* ../yolov3/config
```

Navigate to the `yolov3` folder. You'll then need to create your own `chars.data` file in `config`. From there, run

```
pip3 install -r requirements.txt
python3 train.py --data_config config/chars.data
```